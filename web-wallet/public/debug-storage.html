<!DOCTYPE html>
<html>
<head>
  <title>Storage Debug - Ztarknet</title>
  <style>
    body { font-family: monospace; padding: 20px; background: #1a1a1a; color: #ddd; }
    h1, h2 { color: #ff6b1a; }
    pre { background: #0a0a0a; padding: 15px; border-radius: 8px; overflow-x: auto; border: 1px solid #333; }
    .section { margin: 20px 0; padding: 15px; background: #222; border-radius: 8px; }
    .key { color: #50c878; }
    .value { color: #89cff0; }
    button {
      background: #ff6b1a;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 5px;
      cursor: pointer;
      margin: 5px;
    }
    button:hover { background: #ff8a3d; }
  </style>
</head>
<body>
  <h1>Ztarknet Storage Debugger</h1>

  <div class="section">
    <h2>Web Wallet Accounts</h2>
    <pre id="webwallet-accounts"></pre>
  </div>

  <div class="section">
    <h2>Zart-Peace (artpeace) Accounts</h2>
    <pre id="artpeace-accounts"></pre>
  </div>

  <div class="section">
    <h2>All Storage Keys</h2>
    <button onclick="showAllStorage()">Show All Storage</button>
    <button onclick="clearArtpeaceStorage()">Clear Artpeace Storage</button>
    <pre id="all-storage"></pre>
  </div>

  <script>
    function formatStorage(pattern) {
      let output = '';
      let count = 0;

      for (let i = 0; i < localStorage.length; i++) {
        const key = localStorage.key(i);
        if (key && key.includes(pattern)) {
          count++;
          const value = localStorage.getItem(key);
          const displayValue = value && value.length > 50 ? value.substring(0, 50) + '...' : value;
          output += `${count}. Key: ${key}\n   Value: ${displayValue}\n\n`;
        }
      }

      return output || 'No items found';
    }

    function showAllStorage() {
      let output = '';
      const keys = [];

      for (let i = 0; i < localStorage.length; i++) {
        const key = localStorage.key(i);
        if (key) keys.push(key);
      }

      keys.sort();

      for (const key of keys) {
        const value = localStorage.getItem(key);
        const displayValue = value && value.length > 50 ? value.substring(0, 50) + '...' : value;
        output += `Key: ${key}\nValue: ${displayValue}\n\n`;
      }

      document.getElementById('all-storage').textContent = output || 'No items found';
    }

    function clearArtpeaceStorage() {
      if (!confirm('Are you sure you want to clear all artpeace storage?')) return;

      const keysToRemove = [];
      for (let i = 0; i < localStorage.length; i++) {
        const key = localStorage.key(i);
        if (key && key.includes('artpeace')) {
          keysToRemove.push(key);
        }
      }

      keysToRemove.forEach(key => localStorage.removeItem(key));
      alert(`Removed ${keysToRemove.length} artpeace storage items`);
      location.reload();
    }

    // Load on page load
    document.getElementById('webwallet-accounts').textContent = formatStorage('webwallet');
    document.getElementById('artpeace-accounts').textContent = formatStorage('artpeace');
  </script>
</body>
</html>
